"use strict";(self.webpackChunkkingsapp=self.webpackChunkkingsapp||[]).push([[307],{9307:(fe,G,m)=>{m.r(G),m.d(G,{FlightBookingModule:()=>he});var g=m(177),a=m(9417),f=m(8834),c=m(5596),A=m(9213),P=m(9631),C=m(5084),T=m(6600),I=m(2798),u=m(882),h=m(7062),t=m(7705);let w=(()=>{class n{ngOnInit(){}static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-flight-booking"]],decls:1,vars:0,template:function(r,o){1&r&&t.nrm(0,"router-outlet")},dependencies:[h.n3]})}return n})();var O=m(3100),y=m(5416),tt=m(4103);function et(n,s){if(1&n&&(t.j41(0,"mat-option",21),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.Y8G("value",e),t.R7$(1),t.JRh(e)}}function rt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Title is required "),t.k0s())}function nt(n,s){if(1&n&&(t.j41(0,"mat-option",21),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.Y8G("value",e),t.R7$(1),t.JRh(e)}}function ot(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Gender is required "),t.k0s())}function at(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," First Name is required "),t.k0s())}function it(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Only alphabets are allowed "),t.k0s())}function st(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Surname is required "),t.k0s())}function lt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Only alphabets are allowed "),t.k0s())}function ct(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Date of Birth is required "),t.k0s())}function pt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Passport Number is required "),t.k0s())}function mt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Invalid Passport Number "),t.k0s())}function dt(n,s){if(1&n&&(t.j41(0,"mat-option",21),t.nrm(1,"img",22),t.EFF(2),t.k0s()),2&n){const e=s.$implicit;t.Y8G("value",e.name.common),t.R7$(1),t.Y8G("src",e.flags.svg,t.B4B)("alt",e.name.common+" flag"),t.R7$(1),t.SpI(" ",e.name.common," ")}}function gt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Nationality is required "),t.k0s())}function ut(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Email is required "),t.k0s())}function ht(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Invalid Email Address "),t.k0s())}function ft(n,s){if(1&n&&(t.j41(0,"mat-option",21),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.Y8G("value",e),t.R7$(1),t.SpI(" ",e," ")}}function _t(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Call code is required "),t.k0s())}function Ft(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Phone number is required. "),t.k0s())}function Ct(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Invalid Nigerian phone number. "),t.k0s())}let R=(()=>{class n{constructor(e,r){this.fb=e,this.registerService=r,this.titles=["Mr","Ms","Mrs","Dr"],this.Gender=["Male","Female"],this.countries=[],this.callCodes=[]}ngOnInit(){console.log("Passenger Form Group Initialized:",this.passengerFormGroup),this.passengerFormGroup||(this.passengerFormGroup=this.fb.group({title:["",a.k0.required],Gender:["",a.k0.required],firstName:["",[a.k0.required,a.k0.pattern("[a-zA-Z]+")]],surName:["",[a.k0.required,a.k0.pattern("[a-zA-Z]+")]],dateOfBirth:["",a.k0.required],passportNumber:["",[a.k0.required,a.k0.pattern("[A-Z0-9]+")]],nationality:["",a.k0.required],callCode:["",a.k0.required],email:["",[a.k0.required,a.k0.email]],phoneNumber:["",[a.k0.required,a.k0.pattern(/^(?:\+234|0)[789]\d{9}$/)]]})),this.loadCountries(),this.getCallCodes()}loadCountries(){this.registerService.getCountries().subscribe(e=>{this.countries=e;const r=this.countries.find(o=>"Nigeria"===o.name.common);r&&this.passengerFormGroup.patchValue({nationality:r.name.common})},e=>{console.log("Unable to fetch country data",e)})}getCallCodes(){this.registerService.getCountryCallCodes().subscribe(e=>{this.callCodes=e.filter(o=>o.idd?.root&&o.idd?.suffixes).map(o=>`${o.idd.root}${o.idd.suffixes[0]}`);const r=this.callCodes.find(o=>"+234"===o);this.passengerFormGroup.patchValue({callCode:r||""})})}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(a.ok),t.rXU(tt.h))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-passenger-info-iterate"]],inputs:{passengerFormGroup:"passengerFormGroup",index:"index"},decls:76,vars:23,consts:[[1,"passenger-container"],[1,"passenger-card"],[3,"formGroup"],[1,"form-row"],["appearance","outline"],["formControlName","title","required",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","Gender","required",""],["matInput","","formControlName","firstName","required",""],["matInput","","formControlName","surName","required",""],["matInput","","formControlName","dateOfBirth","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["matInput","","formControlName","passportNumber","required",""],["formControlName","nationality","placeholder","Select your nationality"],["matInput","","formControlName","email","required",""],["formControlName","callCode","required",""],["matInput","","formControlName","phoneNumber","required",""],[1,"passenger-info-text"],[1,"lightbulb-icon"],[3,"value"],["width","20",3,"src","alt"]],template:function(r,o){if(1&r&&(t.j41(0,"div",0)(1,"mat-card",1)(2,"mat-card-title"),t.EFF(3),t.k0s(),t.j41(4,"mat-card-content",2)(5,"div",3)(6,"mat-form-field",4)(7,"mat-label"),t.EFF(8,"Title"),t.k0s(),t.j41(9,"mat-select",5),t.DNE(10,et,2,2,"mat-option",6),t.k0s(),t.DNE(11,rt,2,0,"mat-error",7),t.k0s(),t.j41(12,"mat-form-field",4)(13,"mat-label"),t.EFF(14,"Gender"),t.k0s(),t.j41(15,"mat-select",8),t.DNE(16,nt,2,2,"mat-option",6),t.k0s(),t.DNE(17,ot,2,0,"mat-error",7),t.k0s()(),t.j41(18,"div",3)(19,"mat-form-field",4)(20,"mat-label"),t.EFF(21,"First Name"),t.k0s(),t.nrm(22,"input",9),t.DNE(23,at,2,0,"mat-error",7),t.DNE(24,it,2,0,"mat-error",7),t.k0s(),t.j41(25,"mat-form-field",4)(26,"mat-label"),t.EFF(27,"Surname"),t.k0s(),t.nrm(28,"input",10),t.DNE(29,st,2,0,"mat-error",7),t.DNE(30,lt,2,0,"mat-error",7),t.k0s()(),t.j41(31,"div",3)(32,"mat-form-field",4)(33,"mat-label"),t.EFF(34,"Date of Birth"),t.k0s(),t.nrm(35,"input",11)(36,"mat-datepicker-toggle",12)(37,"mat-datepicker",null,13),t.DNE(39,ct,2,0,"mat-error",7),t.k0s(),t.j41(40,"mat-form-field",4)(41,"mat-label"),t.EFF(42,"Passport Number"),t.k0s(),t.nrm(43,"input",14),t.DNE(44,pt,2,0,"mat-error",7),t.DNE(45,mt,2,0,"mat-error",7),t.k0s()(),t.j41(46,"div",3)(47,"mat-form-field",4)(48,"mat-label"),t.EFF(49,"Nationality"),t.k0s(),t.j41(50,"mat-select",15),t.DNE(51,dt,3,4,"mat-option",6),t.k0s(),t.DNE(52,gt,2,0,"mat-error",7),t.k0s(),t.j41(53,"mat-form-field",4)(54,"mat-label"),t.EFF(55,"Email"),t.k0s(),t.nrm(56,"input",16),t.DNE(57,ut,2,0,"mat-error",7),t.DNE(58,ht,2,0,"mat-error",7),t.k0s()(),t.j41(59,"div",3)(60,"mat-form-field",4)(61,"mat-label"),t.EFF(62,"Call-Code"),t.k0s(),t.j41(63,"mat-select",17),t.DNE(64,ft,2,2,"mat-option",6),t.k0s(),t.DNE(65,_t,2,0,"mat-error",7),t.k0s(),t.j41(66,"mat-form-field",4)(67,"mat-label"),t.EFF(68,"Phone*"),t.k0s(),t.nrm(69,"input",18),t.DNE(70,Ft,2,0,"mat-error",7),t.DNE(71,Ct,2,0,"mat-error",7),t.k0s()()(),t.j41(72,"div",19)(73,"mat-icon",20),t.EFF(74,"lightbulb_outline"),t.k0s(),t.EFF(75," Your e-Ticket will be sent to the email address you provide "),t.k0s()()()),2&r){const i=t.sdS(38);let l,p,d,F,b,v,E,x,D,j,Z,H,K,W,Q;t.R7$(3),t.SpI("Passenger ",o.index,""),t.R7$(1),t.Y8G("formGroup",o.passengerFormGroup),t.R7$(6),t.Y8G("ngForOf",o.titles),t.R7$(1),t.Y8G("ngIf",null==(l=o.passengerFormGroup.get("title"))?null:l.hasError("required")),t.R7$(5),t.Y8G("ngForOf",o.Gender),t.R7$(1),t.Y8G("ngIf",null==(p=o.passengerFormGroup.get("Gender"))?null:p.hasError("required")),t.R7$(6),t.Y8G("ngIf",null==(d=o.passengerFormGroup.get("firstName"))?null:d.hasError("required")),t.R7$(1),t.Y8G("ngIf",null==(F=o.passengerFormGroup.get("firstName"))?null:F.hasError("pattern")),t.R7$(5),t.Y8G("ngIf",null==(b=o.passengerFormGroup.get("surName"))?null:b.hasError("required")),t.R7$(1),t.Y8G("ngIf",null==(v=o.passengerFormGroup.get("surName"))?null:v.hasError("pattern")),t.R7$(5),t.Y8G("matDatepicker",i),t.R7$(1),t.Y8G("for",i),t.R7$(3),t.Y8G("ngIf",null==(E=o.passengerFormGroup.get("dateOfBirth"))?null:E.hasError("required")),t.R7$(5),t.Y8G("ngIf",null==(x=o.passengerFormGroup.get("passportNumber"))?null:x.hasError("required")),t.R7$(1),t.Y8G("ngIf",null==(D=o.passengerFormGroup.get("passportNumber"))?null:D.hasError("pattern")),t.R7$(6),t.Y8G("ngForOf",o.countries),t.R7$(1),t.Y8G("ngIf",(null==(j=o.passengerFormGroup.get("nationality"))?null:j.invalid)&&(null==(j=o.passengerFormGroup.get("nationality"))?null:j.touched)),t.R7$(5),t.Y8G("ngIf",null==(Z=o.passengerFormGroup.get("email"))?null:Z.hasError("required")),t.R7$(1),t.Y8G("ngIf",null==(H=o.passengerFormGroup.get("email"))?null:H.hasError("email")),t.R7$(6),t.Y8G("ngForOf",o.callCodes),t.R7$(1),t.Y8G("ngIf",null==(K=o.passengerFormGroup.get("callCode"))?null:K.hasError("required")),t.R7$(5),t.Y8G("ngIf",null==(W=o.passengerFormGroup.get("phoneNumber"))?null:W.hasError("required")),t.R7$(1),t.Y8G("ngIf",null==(Q=o.passengerFormGroup.get("phoneNumber"))?null:Q.hasError("pattern"))}},dependencies:[g.Sq,g.bT,a.me,a.BC,a.cb,a.YS,a.j4,a.JD,T.wT,P.fg,u.rl,u.nJ,u.TL,u.yw,c.RN,c.m2,c.dh,A.An,I.VO,C.Vh,C.bZ,C.bU],styles:[".passenger-container[_ngcontent-%COMP%]{max-height:500px;overflow-y:auto;padding:16px}.passenger-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.passenger-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}.passenger-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#888;border-radius:10px;border:3px solid #f1f1f1}.passenger-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background-color:#555}.passenger-card[_ngcontent-%COMP%]{margin-bottom:16px;padding:16px;overflow:hidden}.form-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:5px}mat-form-field[_ngcontent-%COMP%]{flex:1 1 45%}"]})}return n})();function bt(n,s){if(1&n&&(t.j41(0,"div"),t.nrm(1,"app-passenger-info-iterate",7),t.k0s()),2&n){const e=s.$implicit,r=s.index,o=t.XpG();t.R7$(1),t.Y8G("passengerFormGroup",o.getPassengerFormGroup(e))("index",r+1)}}let $=(()=>{class n{constructor(e,r,o,i,l){this.fb=e,this.router=r,this.route=o,this.authservice=i,this.snackBar=l,this.userId=this.authservice.getUserId()}ngOnInit(){this.route.queryParams.subscribe(e=>{const r=+e.totalPassengers||0;r>0?this.initializeForm(r):(console.error("Invalid number of passengers"),this.snackBar.open("Invalid number of passengers. Please start the booking process again.","Close",{duration:5e3}),this.router.navigate(["/flight-booking/booking-details"]))}),this.userId=this.authservice.getUserId()}initializeForm(e){this.passengerForm=this.fb.group({passengers:this.fb.array([])}),this.generatePassengerForms(e)}get passengers(){return this.passengerForm.get("passengers")}generatePassengerForms(e){for(let r=0;r<e;r++)this.passengers.push(this.createPassengerFormGroup(r))}createPassengerFormGroup(e){return this.fb.group({title:["",a.k0.required],Gender:["",a.k0.required],firstName:["",[a.k0.required,a.k0.pattern("[a-zA-Z]+")]],surName:["",[a.k0.required,a.k0.pattern("[a-zA-Z]+")]],dateOfBirth:["",a.k0.required],passportNumber:["",[a.k0.required,a.k0.pattern("[A-Z0-9]+")]],nationality:["",a.k0.required],callCode:["",a.k0.required],email:["",[a.k0.required,a.k0.email]],phoneNumber:["",[a.k0.required,a.k0.pattern(/^(?:\+234|0)[789]\d{9}$/)]]})}getPassengerFormGroup(e){return e}onSubmit(){if(this.passengerForm.valid){const e=this.passengers.length,r=this.route.snapshot.queryParams;this.userId=this.authservice.getUserId(),this.router.navigate(["flight-booking/seats"],{queryParams:{totalPassengers:e,departureAirportName:r.departureAirportName,arrivalAirportName:r.arrivalAirportName,flightCompany:r.flightCompany,price:r.price,departureTime:r.departureTime,arrivalTime:r.arrivalTime,userId:this.userId}})}else this.passengerForm.markAllAsTouched(),this.snackBar.open("Please fill out all required fields correctly.","Close",{duration:3e3})}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(a.ok),t.rXU(h.Ix),t.rXU(h.nX),t.rXU(O.u),t.rXU(y.UG))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-passenger-info"]],decls:8,vars:3,consts:[[1,"passenger-info-container"],[1,"form-container"],[3,"formGroup","ngSubmit"],["formArrayName","passengers"],[4,"ngFor","ngForOf"],[1,"actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled","click"],[3,"passengerFormGroup","index"]],template:function(r,o){1&r&&(t.j41(0,"div",0)(1,"div",1)(2,"form",2),t.bIt("ngSubmit",function(){return o.onSubmit()}),t.j41(3,"div",3),t.DNE(4,bt,2,2,"div",4),t.k0s()()(),t.j41(5,"div",5)(6,"button",6),t.bIt("click",function(){return o.onSubmit()}),t.EFF(7," Continue to Flight Details "),t.k0s()()()),2&r&&(t.R7$(2),t.Y8G("formGroup",o.passengerForm),t.R7$(2),t.Y8G("ngForOf",o.passengers.controls),t.R7$(2),t.Y8G("disabled",o.passengerForm.invalid))},dependencies:[g.Sq,a.qT,a.cb,a.j4,a.v8,f.$z,R],styles:['@charset "UTF-8";.passenger-info-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;max-height:100%;overflow:hidden}.passenger-info-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px;box-sizing:border-box}.passenger-info-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{background-color:#fff;padding:16px;border-top:1px solid #ddd;display:flex;justify-content:center;position:sticky;bottom:0;width:100%;box-shadow:0 -1px 5px #0000001a}.passenger-container[_ngcontent-%COMP%]{max-height:100%;overflow-y:auto;padding:16px}.passenger-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.passenger-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}.passenger-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#888;border-radius:10px;border:3px solid #f1f1f1}.passenger-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background-color:#555}.passenger-card[_ngcontent-%COMP%]{margin-bottom:16px;padding:16px;overflow:hidden}.form-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:16px}mat-form-field[_ngcontent-%COMP%]{flex:1 1 45%}']})}return n})();var _=m(5351);let kt=(()=>{class n{constructor(e){this.dialogRef=e,this.clearInput=new t.bkB}closeDialog(){this.dialogRef.close(),this.clearInput.emit()}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(_.CP))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-no-airports-found"]],outputs:{clearInput:"clearInput"},decls:11,vars:0,consts:[[1,"no-airports-card"],["src","https://media.istockphoto.com/id/182210605/photo/flight-over-the-usa.webp?b=1&s=170667a&w=0&k=20&c=dR4PuK5nFB-P06yrrKnfZ_pW5Za9MetLQQUDUDPV0_E=","alt","Logo",1,"logo"],["mat-raised-button","","color","primary",3,"click"]],template:function(r,o){1&r&&(t.j41(0,"mat-card",0),t.nrm(1,"img",1),t.j41(2,"mat-card-header")(3,"mat-card-title"),t.EFF(4,"No Airports Found"),t.k0s()(),t.j41(5,"mat-card-content")(6,"p"),t.EFF(7,"Sorry There were no flights found for this route and date combination. we suggest you modify your search and try again."),t.k0s()(),t.j41(8,"mat-card-actions")(9,"button",2),t.bIt("click",function(){return o.closeDialog()}),t.EFF(10,"Close"),t.k0s()()())},dependencies:[f.$z,c.RN,c.YY,c.m2,c.MM,c.dh],styles:[".no-airports-card[_ngcontent-%COMP%]{padding:20px;border-radius:8px;max-width:300px;margin:auto}.logo[_ngcontent-%COMP%]{width:100%;height:auto;display:block}mat-card-content[_ngcontent-%COMP%]{font-size:16px}mat-card-content[_ngcontent-%COMP%]   .sub-img[_ngcontent-%COMP%]{width:50px}mat-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:center}button[mat-button][_ngcontent-%COMP%]{color:#3f51b5}"]})}return n})(),vt=(()=>{class n{constructor(e){this.dialogRef=e}closeDialog(){this.dialogRef.close()}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(_.CP))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-noflightsfound"]],decls:11,vars:0,consts:[[1,"no-airports-card"],["src","assets/not found.jpg","alt","",1,"logo"],["mat-raised-button","","color","primary",3,"click"]],template:function(r,o){1&r&&(t.j41(0,"mat-card",0),t.nrm(1,"img",1),t.j41(2,"mat-card-header")(3,"mat-card-title"),t.EFF(4,"No Available Flight"),t.k0s()(),t.j41(5,"mat-card-content")(6,"p"),t.EFF(7,"Sorry There were no flights found for this route and date combination. we suggest you modify your search and try again."),t.k0s()(),t.j41(8,"mat-card-actions")(9,"button",2),t.bIt("click",function(){return o.closeDialog()}),t.EFF(10,"Close"),t.k0s()()())},dependencies:[f.$z,c.RN,c.YY,c.m2,c.MM,c.dh],styles:[".no-airports-card[_ngcontent-%COMP%]{padding:20px;border-radius:8px;max-width:300px;margin:auto}.logo[_ngcontent-%COMP%]{width:100%;height:auto;display:block}mat-card-content[_ngcontent-%COMP%]{font-size:16px}mat-card-content[_ngcontent-%COMP%]   .sub-img[_ngcontent-%COMP%]{width:50px}mat-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:center}button[mat-button][_ngcontent-%COMP%]{color:#3f51b5}"]})}return n})();var M=m(9183);let S=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-loadingmodal"]],decls:5,vars:0,consts:[[1,"custom-spinner"],["diameter","50"]],template:function(r,o){1&r&&(t.j41(0,"mat-card",0)(1,"mat-card-content"),t.nrm(2,"mat-spinner",1),t.j41(3,"p"),t.EFF(4,"Loading..."),t.k0s()()())},dependencies:[c.RN,c.m2,M.LG],styles:["mat-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px}mat-spinner[_ngcontent-%COMP%]{margin-bottom:10px;width:20px;height:20px}"]})}return n})();var yt=m(6354),Y=m(9437),U=m(7673),k=m(1626);let B=(()=>{class n{constructor(e){this.http=e,this.aeroDataBoxApiKey="d011cac226mshb2f70dd2115f260p1cd928jsn1543f5e3df72",this.aeroDataBoxUrl="https://aerodatabox.p.rapidapi.com",this.ninjaApiUrl="https://airports-by-api-ninjas.p.rapidapi.com/v1/airports",this.openSkyUrl="https://opensky-network.org/api",this.backendUrl="https://localhost:3000/api",this.rapidApiKey="d011cac226mshb2f70dd2115f260p1cd928jsn1543f5e3df72",this.skyscannerApiHost="sky-scanner3.p.rapidapi.com",this.skyScrapperApiUrl="https://sky-scrapper.p.rapidapi.com/api/v2/flights/searchFlightsComplete"}searchFlights(e,r,o,i){const l=`${this.backendUrl}/check-flight`,p=(new k.Nl).set("departure",e).set("arrival",r).set("departureAirports",o).set("arrivalAirports",i);return this.http.get(l,{params:p}).pipe((0,yt.T)(d=>d.available),(0,Y.W)(d=>(console.error("Error checking flight availability:",d),(0,U.of)(!1))))}getAirportsByLocation(e){const r=`${this.aeroDataBoxUrl}/airports/search/term`,o=new k.Lr({"X-RapidAPI-Key":this.aeroDataBoxApiKey,"X-RapidAPI-Host":"aerodatobox.p.rapidapi.com"}),i=(new k.Nl).set("q",e).set("withFlightInfoOnly","false");return this.http.get(r,{headers:o,params:i})}searchAirports(e){const r=new k.Lr({"x-rapidapi-host":"airports-by-api-ninjas.p.rapidapi.com","x-rapidapi-key":this.aeroDataBoxApiKey}),o=(new k.Nl).set("name",e);return this.http.get(this.ninjaApiUrl,{headers:r,params:o})}getAirportsData(){return this.http.get(`${this.openSkyUrl}/airports`)}searchFlightsSkyScrapper(e,r,o,i,l,p,d,F,b,v){const E=new k.Lr({"x-rapidapi-host":"sky-scrapper.p.rapidapi.com","x-rapidapi-key":this.rapidApiKey}),x=(new k.Nl).set("originSkyId",e).set("destinationSkyId",r).set("originEntityId",o).set("destinationEntityId",i).set("cabinClass",l).set("adults",p.toString()).set("sortBy",d).set("currency",F).set("market",b).set("countryCode",v);return this.http.get(this.skyScrapperApiUrl,{headers:E,params:x}).pipe((0,Y.W)(D=>(console.error("Error searching flights with Sky Scrapper:",D),(0,U.of)(null))))}static#t=this.\u0275fac=function(r){return new(r||n)(t.KVO(k.Qq))};static#e=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var N=m(850),q=m(7575);const Pt=["passengerSelect"];function Ot(n,s){1&n&&t.nrm(0,"mat-progress-bar",34)}function It(n,s){if(1&n&&(t.j41(0,"mat-option",35),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.Y8G("value",e),t.R7$(1),t.Lme(" ",e.name,",",e.country," ")}}function Mt(n,s){if(1&n&&(t.j41(0,"mat-option",35),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.Y8G("value",e),t.R7$(1),t.Lme(" ",e.name,",",e.country," ")}}let X=(()=>{class n{constructor(e,r,o,i,l,p,d,F){this.fb=e,this.router=r,this.airportService=o,this.snackBar=i,this.dialog=l,this.authservice=p,this.route=d,this.datePipe=F,this.departureAirports=[],this.arrivalAirports=[],this.noAirportFoundDeparture=!1,this.noAirportFoundArrival=!1,this.passengerLabel="1 Adult",this.showPassengerSelect=!1,this.isSearchingDeparture=!1,this.isSearchingArrival=!1,this.isModalOpen=!1,this.departureTime="",this.arrivalTime="",this.myDateFilter=b=>!b||b>=new Date}ngOnInit(){this.initializeForm(),this.subscribeToFormChanges(),this.userId=this.authservice.getUserId()||"",this.userId||console.warn("No userId found. Ensure user is logged in.")}initializeForm(){this.bookingForm=this.fb.group({departureCity:["",a.k0.required],arrivalCity:["",a.k0.required],departureDate:["",a.k0.required],returnDate:[""],adults:[1,[a.k0.required,a.k0.min(1)]],children:[0],infants:[0],passengers:this.fb.array([])}),this.updatePassengerLabel()}subscribeToFormChanges(){this.bookingForm.valueChanges.subscribe(()=>{this.updatePassengerLabel()}),this.bookingForm.get("departureCity")?.valueChanges.subscribe(e=>{this.searchAirports(e,"departure")}),this.bookingForm.get("arrivalCity")?.valueChanges.subscribe(e=>{this.searchAirports(e,"arrival")})}searchAirports(e,r){this.searchTimeout&&clearTimeout(this.searchTimeout),e.length>2?this.searchTimeout=setTimeout(()=>{this.toggleSpinner(r,!0),this.airportService.searchAirports(e).subscribe(o=>{this.handleAirportSearchResults(o,r)},o=>{this.handleError(r,"Error searching airports")})},1e3):this.clearAirportResults(r)}handleAirportSearchResults(e,r){"departure"===r?(this.departureAirports=e,this.noAirportFoundDeparture=0===e.length):(this.arrivalAirports=e,this.noAirportFoundArrival=0===e.length),this.toggleSpinner(r,!1),("departure"===r&&this.noAirportFoundDeparture||"arrival"===r&&this.noAirportFoundArrival)&&this.triggerNoAirportsDialog(r)}handleError(e,r){this.toggleSpinner(e,!1),console.error(r),this.snackBar.open(r,"Close",{duration:3e3})}clearAirportResults(e){"departure"===e?(this.departureAirports=[],this.noAirportFoundDeparture=!1):(this.arrivalAirports=[],this.noAirportFoundArrival=!1)}searchForFlights(e,r,o){console.log("abot to submit");const i=this.dialog.open(S,{disableClose:!0});setTimeout(()=>{i.close(),Math.random()<=.6?this.router.navigate(["flight-booking/flight-details"],{queryParams:{departureAirportName:e.name,departureAirportCountry:e.country,arrivalAirportName:r.name,arrivalAirportCountry:r.country,totalPassengers:o,userId:this.userId}}):this.openNoFlightsDialog()},3e3)}onSubmit(){if(this.bookingForm.markAllAsTouched(),this.bookingForm.valid){const e=this.bookingForm.get("departureCity")?.value,r=this.bookingForm.get("arrivalCity")?.value;if(e&&r){const o=this.bookingForm.get("adults")?.value||0,i=this.bookingForm.get("children")?.value||0,l=this.bookingForm.get("infants")?.value||0;this.searchForFlights(e,r,o+i+l)}else console.error("Departure and Arrival fields are required"),this.snackBar.open("Departure and Arrival fields are required.","Close",{duration:3e3})}else console.error("Form is invalid",this.bookingForm),this.snackBar.open("Please complete all required fields.","Close",{duration:3e3})}toggleSpinner(e,r){"departure"===e?this.isSearchingDeparture=r:this.isSearchingArrival=r,r&&setTimeout(()=>{("departure"===e&&this.noAirportFoundDeparture||"arrival"===e&&this.noAirportFoundArrival)&&this.triggerNoAirportsDialog(e)},6e3)}increase(e){const r=this.bookingForm.get(e);r&&(r.setValue(r.value+1),this.updatePassengerLabel())}decrease(e){const r=this.bookingForm.get(e);r&&r.value>0&&(r.setValue(r.value-1),this.updatePassengerLabel())}onDepartureCityInput(e){this.searchAirports(e.target.value,"departure")}onArrivalCityInput(e){this.searchAirports(e.target.value,"arrival")}openPassengerSelect(){this.passengerSelect.open()}closePassengerSelect(){this.passengerSelect.close()}openLoadingModal(){this.dialog.open(S,{disableClose:!0,panelClass:"loading-modal"})}openNoAirportsDialog(e){if(!this.isModalOpen){this.isModalOpen=!0;const r=this.dialog.open(kt,{disableClose:!0});r.componentInstance.clearInput.subscribe(()=>{this.clearInputField(e)}),r.afterClosed().subscribe(()=>{this.isModalOpen=!1})}}displayAirport(e){return e?`${e.name}, ${e.country}`:""}openNoFlightsDialog(){this.isModalOpen||(this.isModalOpen=!0,this.dialog.open(vt,{disableClose:!0}).afterClosed().subscribe(()=>{this.isModalOpen=!1}))}updatePassengerLabel(){const e=this.bookingForm.get("adults")?.value||0,r=this.bookingForm.get("children")?.value||0,o=this.bookingForm.get("infants")?.value||0;this.passengerLabel=`${e} Adult${e>1?"s":""}`,r>0&&(this.passengerLabel+=` ${r} Child${r>1?"ren":""}`),o>0&&(this.passengerLabel+=`${o} Infant${o>1?"s":""}`)}swapCities(){const e=this.bookingForm.get("departureCity")?.value,r=this.bookingForm.get("arrivalCity")?.value;this.bookingForm.patchValue({departureCity:r,arrivalCity:e}),this.searchAirports(r,"departure"),this.searchAirports(e,"arrival")}triggerNoAirportsDialog(e){this.openNoAirportsDialog(e)}clearInputField(e){"departure"===e?(this.bookingForm.patchValue({departureCity:""}),this.departureAirports=[],this.noAirportFoundDeparture=!1):(this.bookingForm.patchValue({arrivalCity:""}),this.arrivalAirports=[],this.noAirportFoundArrival=!1)}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(a.ok),t.rXU(h.Ix),t.rXU(B),t.rXU(y.UG),t.rXU(_.bZ),t.rXU(O.u),t.rXU(h.nX),t.rXU(g.vh))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-booking-details"]],viewQuery:function(r,o){if(1&r&&t.GBs(Pt,5),2&r){let i;t.mGM(i=t.lsd())&&(o.passengerSelect=i.first)}},features:[t.Jv_([g.vh])],decls:108,vars:19,consts:[[1,"booking-form-container"],[1,"booking-card"],["mode","query",4,"ngIf"],[1,"fas","fa-plane-departure"],[3,"formGroup","ngSubmit"],[1,"form-row"],["appearance","outline",1,"half-width"],["for","departureCity"],["matPrefix",""],["matInput","","id","departureCity","placeholder","Enter departure city or country","formControlName","departureCity",3,"matAutocomplete","input"],[3,"displayWith"],["autoDeparture","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"flow-icon",3,"click"],["for","arrivalCity"],["matInput","","id","arrivalCity","placeholder","Enter arrival city or country","formControlName","arrivalCity",3,"matAutocomplete","input"],["autoArrival","matAutocomplete"],[1,"form-row",2,"gap","25px"],["for","departureDate"],["matInput","","id","departureDate","formControlName","departureDate",3,"matDatepicker","matDatepickerFilter"],["matSuffix","",3,"for"],["departureDatePicker",""],["for","returnDate"],["matInput","","id","returnDate","formControlName","returnDate",3,"matDatepicker","matDatepickerFilter"],["returnDatePicker",""],["appearance","outline",1,"full-width"],["for","passengers"],["matInput","","id","passengers","readonly","",3,"value","click"],[3,"selectionChange"],["passengerSelect",""],["mat-icon-button","",1,"select-button",3,"click"],[1,"passenger-type"],["mat-icon-button","",3,"click"],["mat-raised-button","","color","primary","type","submit"],["mode","query"],[3,"value"]],template:function(r,o){if(1&r&&(t.j41(0,"div",0)(1,"mat-card",1),t.DNE(2,Ot,1,0,"mat-progress-bar",2),t.j41(3,"mat-card-title"),t.nrm(4,"i",3),t.k0s(),t.j41(5,"mat-card-content")(6,"form",4),t.bIt("ngSubmit",function(){return o.onSubmit()}),t.j41(7,"div",5)(8,"mat-form-field",6)(9,"mat-label",7),t.EFF(10,"Departure Airport"),t.k0s(),t.j41(11,"mat-icon",8),t.EFF(12,"location_on"),t.k0s(),t.j41(13,"input",9),t.bIt("input",function(l){return o.onDepartureCityInput(l)}),t.k0s(),t.j41(14,"mat-autocomplete",10,11),t.DNE(16,It,2,3,"mat-option",12),t.k0s()(),t.j41(17,"div",13),t.bIt("click",function(){return o.swapCities()}),t.j41(18,"mat-icon"),t.EFF(19,"swap_horiz"),t.k0s()(),t.j41(20,"mat-form-field",6)(21,"mat-label",14),t.EFF(22,"Arrival Airport"),t.k0s(),t.j41(23,"mat-icon",8),t.EFF(24,"location_on"),t.k0s(),t.j41(25,"input",15),t.bIt("input",function(l){return o.onArrivalCityInput(l)}),t.k0s(),t.j41(26,"mat-autocomplete",10,16),t.DNE(28,Mt,2,3,"mat-option",12),t.k0s()()(),t.j41(29,"div",17)(30,"mat-form-field",6)(31,"mat-label",18),t.EFF(32,"Departure Date"),t.k0s(),t.j41(33,"mat-icon",8),t.EFF(34,"event"),t.k0s(),t.nrm(35,"input",19)(36,"mat-datepicker-toggle",20)(37,"mat-datepicker",null,21),t.k0s(),t.j41(39,"mat-form-field",6)(40,"mat-label",22),t.EFF(41,"Return Date"),t.k0s(),t.j41(42,"mat-icon",8),t.EFF(43,"event"),t.k0s(),t.nrm(44,"input",23)(45,"mat-datepicker-toggle",20)(46,"mat-datepicker",null,24),t.k0s()(),t.j41(48,"div",5)(49,"mat-form-field",25)(50,"mat-label",26),t.EFF(51,"Passengers"),t.k0s(),t.j41(52,"input",27),t.bIt("click",function(){return o.openPassengerSelect()}),t.k0s()(),t.j41(53,"mat-form-field",25)(54,"mat-select",28,29),t.bIt("selectionChange",function(){return o.updatePassengerLabel()}),t.j41(56,"button",30),t.bIt("click",function(){return o.closePassengerSelect()}),t.j41(57,"mat-icon"),t.EFF(58,"close"),t.k0s()(),t.j41(59,"mat-select-trigger"),t.EFF(60),t.k0s(),t.j41(61,"mat-option")(62,"div",31)(63,"mat-icon"),t.EFF(64,"person"),t.k0s(),t.j41(65,"span"),t.EFF(66,"Adults"),t.k0s(),t.j41(67,"button",32),t.bIt("click",function(){return o.decrease("adults")}),t.j41(68,"mat-icon"),t.EFF(69,"remove"),t.k0s()(),t.j41(70,"span"),t.EFF(71),t.k0s(),t.j41(72,"button",32),t.bIt("click",function(){return o.increase("adults")}),t.j41(73,"mat-icon"),t.EFF(74,"add"),t.k0s()()()(),t.j41(75,"mat-option")(76,"div",31)(77,"mat-icon"),t.EFF(78,"child_care"),t.k0s(),t.j41(79,"span"),t.EFF(80,"Children"),t.k0s(),t.j41(81,"button",32),t.bIt("click",function(){return o.decrease("children")}),t.j41(82,"mat-icon"),t.EFF(83,"remove"),t.k0s()(),t.j41(84,"span"),t.EFF(85),t.k0s(),t.j41(86,"button",32),t.bIt("click",function(){return o.increase("children")}),t.j41(87,"mat-icon"),t.EFF(88,"add"),t.k0s()()()(),t.j41(89,"mat-option")(90,"div",31)(91,"mat-icon"),t.EFF(92,"baby"),t.k0s(),t.j41(93,"span"),t.EFF(94,"Infants"),t.k0s(),t.j41(95,"button",32),t.bIt("click",function(){return o.decrease("infants")}),t.j41(96,"mat-icon"),t.EFF(97,"remove"),t.k0s()(),t.j41(98,"span"),t.EFF(99),t.k0s(),t.j41(100,"button",32),t.bIt("click",function(){return o.increase("infants")}),t.j41(101,"mat-icon"),t.EFF(102,"add"),t.k0s()()()()()()(),t.j41(103,"div",5)(104,"button",33),t.nrm(105,"i",3),t.EFF(106," Search Flights "),t.k0s()()()()(),t.nrm(107,"router-outlet"),t.k0s()),2&r){const i=t.sdS(15),l=t.sdS(27),p=t.sdS(38),d=t.sdS(47);let F,b,v;t.R7$(2),t.Y8G("ngIf",o.isSearchingDeparture||o.isSearchingArrival),t.R7$(4),t.Y8G("formGroup",o.bookingForm),t.R7$(7),t.Y8G("matAutocomplete",i),t.R7$(1),t.Y8G("displayWith",o.displayAirport),t.R7$(2),t.Y8G("ngForOf",o.departureAirports),t.R7$(9),t.Y8G("matAutocomplete",l),t.R7$(1),t.Y8G("displayWith",o.displayAirport),t.R7$(2),t.Y8G("ngForOf",o.arrivalAirports),t.R7$(7),t.Y8G("matDatepicker",p)("matDatepickerFilter",o.myDateFilter),t.R7$(1),t.Y8G("for",p),t.R7$(8),t.Y8G("matDatepicker",d)("matDatepickerFilter",o.myDateFilter),t.R7$(1),t.Y8G("for",d),t.R7$(7),t.Y8G("value",o.passengerLabel),t.R7$(8),t.SpI(" ",o.passengerLabel," "),t.R7$(11),t.JRh(null==(F=o.bookingForm.get("adults"))?null:F.value),t.R7$(14),t.JRh(null==(b=o.bookingForm.get("children"))?null:b.value),t.R7$(14),t.JRh(null==(v=o.bookingForm.get("infants"))?null:v.value)}},dependencies:[g.Sq,g.bT,h.n3,a.qT,a.me,a.BC,a.cb,a.j4,a.JD,N.$3,T.wT,N.pN,P.fg,u.rl,u.nJ,u.JW,u.yw,q.HM,f.$z,f.iY,c.RN,c.m2,c.dh,A.An,I.VO,I.$2,C.Vh,C.bZ,C.bU],styles:[".booking-form-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:20px;overflow-y:hidden}.booking-form-container[_ngcontent-%COMP%]   .booking-card[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;max-width:800px;display:flex;flex-direction:column;padding:20px;overflow-y:auto;box-shadow:0 2px 10px #0000001a}.booking-form-container[_ngcontent-%COMP%]   .booking-card[_ngcontent-%COMP%]   mat-progress-bar[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%}.form-row[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:3px}@media (max-width: 768px){.form-row[_ngcontent-%COMP%]{flex-direction:column;width:100%}}.half-width[_ngcontent-%COMP%]{width:48%}@media (max-width: 768px){.half-width[_ngcontent-%COMP%]{width:100%;gap:3px}}.full-width[_ngcontent-%COMP%]{width:100%}.flow-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin:0 8px;font-size:30%;cursor:pointer}.flow-icon[_ngcontent-%COMP%]:hover{background:rgb(250,216,122);border-radius:50%;padding:5px}@media (max-width: 768px){.flow-icon[_ngcontent-%COMP%]{margin:3px 0}}.passenger-type[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:8px}.passenger-type[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.passenger-type[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .passenger-type[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 8px}mat-card-title[_ngcontent-%COMP%]{text-align:center;margin:16px 0;font-size:1.5em}.select-button[_ngcontent-%COMP%]{display:flex;justify-content:center}.select-button[_ngcontent-%COMP%]:hover{background:red;border-radius:50%}"]})}return n})();var V=m(6192);let Et=(()=>{class n{constructor(e,r,o){this.dialogRef=e,this.flightbookingstore=r,this.snackBar=o,this.isAnimationFinished=!1}ngOnInit(){setTimeout(()=>{this.isAnimationFinished=!0},4e3)}closeDialog(){this.dialogRef.close(),this.snackBar.open("View booked flights on User-profile","Close",{duration:2e3})}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(_.CP),t.rXU(V.I),t.rXU(y.UG))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-paymentsuccess"]],decls:11,vars:2,consts:[[1,"payment-success-card"],[1,"checkmark-circle"],[1,"checkmark"],["mat-raised-button","","color","primary",3,"click"]],template:function(r,o){1&r&&(t.j41(0,"mat-card",0)(1,"mat-card-content")(2,"div",1),t.nrm(3,"div",2),t.k0s(),t.j41(4,"h2"),t.EFF(5,"Payment Successful!"),t.k0s(),t.j41(6,"p"),t.EFF(7,"Enjoy your flight."),t.k0s()(),t.j41(8,"mat-card-actions")(9,"button",3),t.bIt("click",function(){return o.closeDialog()}),t.EFF(10,"OK"),t.k0s()()()),2&r&&(t.R7$(2),t.AVh("finished",o.isAnimationFinished))},dependencies:[f.$z,c.RN,c.YY,c.m2],styles:[".payment-success-card[_ngcontent-%COMP%]{text-align:center;padding:20px}.checkmark-circle[_ngcontent-%COMP%]{width:80px;height:80px;background-color:#4caf50;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;position:relative;animation:_ngcontent-%COMP%_spin 2s ease-out forwards}.checkmark[_ngcontent-%COMP%]{width:30px;height:55px;border:solid white;border-width:0 0 6px 6px;transform:rotate(45deg) scale(0);transition:transform .5s ease-out 2s;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(45deg) scale(0)}.checkmark-circle.finished[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{transform:translate(-50%,-50%) rotate(45deg) scale(1)}mat-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:center}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})}return n})();function xt(n,s){1&n&&(t.j41(0,"span",9),t.EFF(1,"Copied!"),t.k0s())}function Dt(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",4)(1,"h3"),t.EFF(2,"Your OTP is:"),t.k0s(),t.j41(3,"div",5),t.EFF(4),t.k0s(),t.j41(5,"button",6),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.copyOtp())}),t.nrm(6,"i",7),t.EFF(7," Copy "),t.k0s(),t.DNE(8,xt,2,0,"span",8),t.k0s()}if(2&n){const e=t.XpG();t.R7$(4),t.JRh(e.otp),t.R7$(4),t.Y8G("ngIf",e.copySuccess)}}let jt=(()=>{class n{constructor(e,r){this.dialogRef=e,this.data=r,this.countdown=59,this.countdownValue=100,this.otp="",this.otpGenerated=!1,this.copySuccess=!1}ngOnInit(){this.startCountdown()}startCountdown(){const e=setInterval(()=>{this.countdown--,this.countdownValue=this.countdown/59*100,0===this.countdown&&(clearInterval(e),this.copySuccess||(this.copySuccess=!0,this.dialogRef.close({otpCopied:this.copyOtp,otp:this.otp}))),!this.otpGenerated&&this.countdown<=Math.floor(59*Math.random())&&(this.otp=this.generateOtp(),this.otpGenerated=!0)},1e3)}generateOtp(){return Math.floor(1e5+9e5*Math.random()).toString()}copyOtp(){this.otp&&navigator.clipboard.writeText(this.otp).then(()=>{this.copySuccess=!0,this.dialogRef.close({otpCopied:!0,otp:this.otp})})}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(_.CP),t.rXU(_.Vh))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-otpmodal"]],decls:9,vars:3,consts:[[1,"spinner-container"],["diameter","100","strokeWidth","10","color","primary","mode","determinate",3,"value"],[1,"countdown"],["class","otp-section",4,"ngIf"],[1,"otp-section"],[1,"otp-code"],["mat-icon-button","",3,"click"],[1,"fas","fa-copy"],["class","copied-message",4,"ngIf"],[1,"copied-message"]],template:function(r,o){1&r&&(t.j41(0,"mat-card")(1,"h2"),t.EFF(2,"OTP Verification"),t.k0s(),t.j41(3,"div",0),t.nrm(4,"mat-progress-spinner",1),t.j41(5,"div",2),t.EFF(6),t.k0s()(),t.DNE(7,Dt,9,2,"div",3),t.nrm(8,"mat-card"),t.k0s()),2&r&&(t.R7$(4),t.Y8G("value",o.countdownValue),t.R7$(2),t.SpI("",o.countdown,"s"),t.R7$(1),t.Y8G("ngIf",o.otpGenerated&&!o.copySuccess))},dependencies:[g.bT,f.iY,c.RN,M.LG],styles:["mat-card[_ngcontent-%COMP%]{text-align:center;padding:5px}mat-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:20px}mat-card[_ngcontent-%COMP%]   .spinner-container[_ngcontent-%COMP%]{position:relative;display:inline-block}mat-card[_ngcontent-%COMP%]   .spinner-container[_ngcontent-%COMP%]   .countdown[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:20px;font-weight:700}mat-card[_ngcontent-%COMP%]   .otp-section[_ngcontent-%COMP%]{margin-top:20px}mat-card[_ngcontent-%COMP%]   .otp-section[_ngcontent-%COMP%]   .otp-code[_ngcontent-%COMP%]{font-size:15px;margin-bottom:10px;letter-spacing:2px}mat-card[_ngcontent-%COMP%]   .otp-copied[_ngcontent-%COMP%]{margin-top:20px;color:green}"]})}return n})();function At(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1,"Card number is required"),t.k0s())}function Tt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1,"Invalid card number"),t.k0s())}function St(n,s){if(1&n&&t.nrm(0,"img",19),2&n){const e=t.XpG(2);t.Y8G("src",e.cardImage,t.B4B)}}function Nt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1,"Card holder name is required"),t.k0s())}function Gt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1,"Expiration date is required"),t.k0s())}function wt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1,"Invalid expiration date"),t.k0s())}function Rt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1,"CVV is required"),t.k0s())}function $t(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1,"Invalid CVV"),t.k0s())}function Yt(n,s){if(1&n){const e=t.RV6();t.j41(0,"div")(1,"mat-card")(2,"h2"),t.EFF(3,"Payment"),t.k0s(),t.j41(4,"form",3),t.bIt("ngSubmit",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.onSubmit())}),t.j41(5,"mat-form-field",4)(6,"label",5),t.EFF(7,"Card Number"),t.k0s(),t.nrm(8,"input",6),t.DNE(9,At,2,0,"mat-error",1),t.DNE(10,Tt,2,0,"mat-error",1),t.k0s(),t.j41(11,"div",7),t.DNE(12,St,1,1,"img",8),t.k0s(),t.j41(13,"mat-form-field",4)(14,"label",9),t.EFF(15,"Card Holder Name"),t.k0s(),t.nrm(16,"input",10),t.DNE(17,Nt,2,0,"mat-error",1),t.k0s(),t.j41(18,"div",11)(19,"mat-form-field",12)(20,"label",13),t.EFF(21,"Expiration Date"),t.k0s(),t.nrm(22,"input",14),t.DNE(23,Gt,2,0,"mat-error",1),t.DNE(24,wt,2,0,"mat-error",1),t.k0s(),t.j41(25,"mat-form-field",12)(26,"label",15),t.EFF(27,"CVV"),t.k0s(),t.nrm(28,"input",16),t.DNE(29,Rt,2,0,"mat-error",1),t.DNE(30,$t,2,0,"mat-error",1),t.k0s()(),t.j41(31,"div",17)(32,"button",18),t.EFF(33,"Pay Now"),t.k0s()()()()()}if(2&n){const e=t.XpG();let r,o,i,l,p,d,F;t.R7$(4),t.Y8G("formGroup",e.paymentForm),t.R7$(5),t.Y8G("ngIf",null==(r=e.paymentForm.get("cardNumber"))?null:r.hasError("required")),t.R7$(1),t.Y8G("ngIf",null==(o=e.paymentForm.get("cardNumber"))?null:o.hasError("pattern")),t.R7$(2),t.Y8G("ngIf",e.cardImage),t.R7$(5),t.Y8G("ngIf",null==(i=e.paymentForm.get("cardHolderName"))?null:i.hasError("required")),t.R7$(6),t.Y8G("ngIf",null==(l=e.paymentForm.get("expirationDate"))?null:l.hasError("required")),t.R7$(1),t.Y8G("ngIf",null==(p=e.paymentForm.get("expirationDate"))?null:p.hasError("pattern")),t.R7$(5),t.Y8G("ngIf",null==(d=e.paymentForm.get("cvv"))?null:d.hasError("required")),t.R7$(1),t.Y8G("ngIf",null==(F=e.paymentForm.get("cvv"))?null:F.hasError("pattern")),t.R7$(2),t.Y8G("disabled",e.paymentForm.invalid)}}function Ut(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1,"OTP is required"),t.k0s())}function Bt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1,"Invalid OTP"),t.k0s())}function qt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1,"Incorrect OTP"),t.k0s())}function Xt(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",20)(1,"mat-card")(2,"h2"),t.EFF(3,"OTP Verification"),t.k0s(),t.j41(4,"form",3),t.bIt("ngSubmit",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.onOtpSubmit())}),t.j41(5,"mat-form-field",4)(6,"label",21),t.EFF(7,"Enter OTP"),t.k0s(),t.nrm(8,"input",22),t.DNE(9,Ut,2,0,"mat-error",1),t.DNE(10,Bt,2,0,"mat-error",1),t.DNE(11,qt,2,0,"mat-error",1),t.k0s(),t.j41(12,"div",17)(13,"button",18),t.EFF(14,"Validate OTP"),t.k0s()()()()()}if(2&n){const e=t.XpG();let r,o,i;t.R7$(4),t.Y8G("formGroup",e.otpForm),t.R7$(5),t.Y8G("ngIf",null==(r=e.otpForm.get("otp"))?null:r.hasError("required")),t.R7$(1),t.Y8G("ngIf",null==(o=e.otpForm.get("otp"))?null:o.hasError("pattern")),t.R7$(1),t.Y8G("ngIf",null==(i=e.otpForm.get("otp"))?null:i.hasError("incorrect")),t.R7$(2),t.Y8G("disabled",e.otpForm.invalid)}}let L=(()=>{class n{constructor(e,r,o,i,l,p){this.fb=e,this.dialog=r,this.authservice=o,this.flightbookingstore=i,this.route=l,this.snackBar=p,this.userId=this.authservice.getUserId(),this.countdown=59,this.countdownValue=100,this.cardImage="",this.otpGenerated=!1,this.generatedOtp="",this.otpModalVisible=!1,this.otpCopied=!1,this.showOtpForm=!1,this.totalPassengers=0,this.selectedDepartureAirport="",this.selectedArrivalAirport="",this.flightCompany="",this.selectedSeats=[],this.departureTime="",this.arrivalTime="",this.price=0}ngOnInit(){this.userId=this.authservice.getUserId()||"",this.route.queryParams.subscribe(e=>{this.totalPassengers=+e.totalPassengers||0,this.selectedDepartureAirport=e.departureAirport||"",this.selectedArrivalAirport=e.arrivalAirport||"",this.flightCompany=e.flightCompany||"",this.price=+e.price||0,this.departureTime=e.departureTime||"",this.arrivalTime=e.arrivalTime||"",this.selectedSeats=e.selectedSeats?e.selectedSeats.split(","):[],this.bookingData={totalPassengers:this.totalPassengers,selectedDepartureAirport:this.selectedDepartureAirport,selectedArrivalAirport:this.selectedArrivalAirport,flightCompany:this.flightCompany,price:this.price,departureTime:this.departureTime,arrivalTime:this.arrivalTime,selectedSeats:this.selectedSeats,userId:this.userId}}),this.paymentForm=this.fb.group({cardNumber:["",[a.k0.required,a.k0.pattern("[0-9]{16}")]],cardHolderName:["",a.k0.required],expirationDate:["",[a.k0.required,a.k0.pattern("(0[1-9]|1[0-2])/?([0-9]{2})")]],cvv:["",[a.k0.required,a.k0.pattern("[0-9]{3}")]]}),this.otpForm=this.fb.group({otp:["",[a.k0.required,a.k0.pattern("[0-9]{6}")]]}),this.paymentForm.get("cardNumber")?.valueChanges.subscribe(e=>{this.detectCardType(e)}),this.paymentForm.get("expirationDate")?.valueChanges.subscribe(e=>{this.formatExpirationDate(e)}),this.paymentForm.get("cvv")?.valueChanges.subscribe(e=>{e.length>3&&this.paymentForm.patchValue({cvv:e.slice(0,3)},{emitEvent:!1})})}detectCardType(e){this.cardImage=/^4[0-9]{12}(?:[0-9]{3})?$/.test(e)?"assets/visa.png":/^5[1-5][0-9]{14}$/.test(e)?"assets/mastercard.png":""}formatExpirationDate(e){e&&2===e.length&&!e.includes("/")&&this.paymentForm.patchValue({expirationDate:`${e}/`},{emitEvent:!1})}onSubmit(){console.log("Payment form submitted"),this.paymentForm.valid?(this.openOtpModal(),this.otpGenerated=!0):this.paymentForm.markAllAsTouched()}openOtpModal(){const e=this.dialog.open(jt,{disableClose:!0,width:"400px"});e.afterClosed().subscribe(r=>{r?.otpCopied&&(this.generatedOtp=r.otp,this.showOtpForm=!0,setTimeout(()=>{e.close()},2e3))})}onOtpSubmit(){console.log("OTP form submission, booking process initiated"),this.otpForm.markAllAsTouched(),this.otpForm.valid&&(this.otpForm.get("otp")?.value===this.generatedOtp?(console.log("OTP validated successfully."),this.processBooking()):(console.log("OTP validation failed."),this.otpForm.get("otp")?.setErrors({incorrect:!0})))}processBooking(){console.log("Attempting to store booking.");const e={flightCompany:this.flightCompany,departureAirport:this.selectedDepartureAirport,arrivalAirport:this.selectedArrivalAirport,departureTime:this.departureTime,arrivalTime:this.arrivalTime,totalPassengers:this.totalPassengers,selectedSeats:this.selectedSeats,price:this.price,userId:this.authservice.getUserId()};this.flightbookingstore.storeBooking(e).subscribe({next:r=>{console.log("Booking stored successfully:",r),this.openLoadingAndSuccessModal()},error:r=>{console.error("Error storing booking:",r),this.snackBar.open("Error storing booking: ","Are you sure you booked a flight?"+JSON.stringify(r))}})}openLoadingAndSuccessModal(){const e=this.dialog.open(S,{disableClose:!0,panelClass:"center-modal"});setTimeout(()=>{e.close(),this.dialog.open(Et,{disableClose:!0,panelClass:"center-modal"}).afterClosed().subscribe(()=>{console.log("Paymentsuccess modal closed.")})},4e3)}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(a.ok),t.rXU(_.bZ),t.rXU(O.u),t.rXU(V.I),t.rXU(h.nX),t.rXU(y.UG))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-payment"]],decls:3,vars:2,consts:[[1,"payment-container"],[4,"ngIf"],["class","otp-modal",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"full-width"],["for","cardNumber"],["matInput","","id","cardNumber","formControlName","cardNumber","autocomplete","cc-number"],[1,"card-image-container"],["alt","Card Logo",3,"src",4,"ngIf"],["for","cardHolderName"],["matInput","","id","cardHolderName","formControlName","cardHolderName","autocomplete","cc-name"],[1,"form-group-inline"],[1,"half-width"],["for","expirationDate"],["matInput","","id","expirationDate","formControlName","expirationDate","autocomplete","cc-exp"],["for","cvv"],["matInput","","id","cvv","formControlName","cvv","type","password","maxlength","3","autocomplete","cc-csc"],[1,"actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["alt","Card Logo",3,"src"],[1,"otp-modal"],["for","otp"],["matInput","","id","otp","formControlName","otp","autocomplete","one-time-code"]],template:function(r,o){1&r&&(t.j41(0,"div",0),t.DNE(1,Yt,34,10,"div",1),t.DNE(2,Xt,15,5,"div",2),t.k0s()),2&r&&(t.R7$(1),t.Y8G("ngIf",!o.showOtpForm),t.R7$(1),t.Y8G("ngIf",o.showOtpForm))},dependencies:[g.bT,a.qT,a.me,a.BC,a.cb,a.tU,a.j4,a.JD,P.fg,u.rl,u.TL,f.$z,c.RN],styles:[".payment-container[_ngcontent-%COMP%]{max-width:400px;margin:0 auto;padding:10px;background-color:#fff;border-radius:8px;box-shadow:0 4px 12px #0000001a}.payment-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:5px}.payment-container[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%}.payment-container[_ngcontent-%COMP%]   .half-width[_ngcontent-%COMP%]{width:48%}.payment-container[_ngcontent-%COMP%]   .form-group-inline[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:15px}.payment-container[_ngcontent-%COMP%]   .card-image-container[_ngcontent-%COMP%]{text-align:right;margin-bottom:15px}.payment-container[_ngcontent-%COMP%]   .card-image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:40px}.payment-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{text-align:center;margin:10px}.payment-container[_ngcontent-%COMP%]   .otp-modal[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;text-align:center;box-shadow:0 4px 12px #0000001a}.payment-container[_ngcontent-%COMP%]   .otp-modal[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:20px}.payment-container[_ngcontent-%COMP%]   .otp-modal[_ngcontent-%COMP%]   .spinner-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-bottom:20px}.payment-container[_ngcontent-%COMP%]   .otp-modal[_ngcontent-%COMP%]   .countdown-text[_ngcontent-%COMP%]{font-size:18px;margin-left:10px}.payment-container[_ngcontent-%COMP%]   .otp-modal[_ngcontent-%COMP%]   .otp-display[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin-bottom:20px}.payment-container[_ngcontent-%COMP%]   .otp-modal[_ngcontent-%COMP%]   .copied-message[_ngcontent-%COMP%]{color:green;margin-left:10px;font-size:14px}"]})}return n})();function Vt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Departure airport is required "),t.k0s())}function Lt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Arrival airport is required "),t.k0s())}function zt(n,s){1&n&&(t.j41(0,"mat-error"),t.EFF(1," Travel date is required "),t.k0s())}function Jt(n,s){1&n&&(t.j41(0,"div",14),t.nrm(1,"mat-spinner"),t.k0s())}function Zt(n,s){if(1&n&&(t.j41(0,"mat-card",17)(1,"mat-card-header")(2,"mat-card-title"),t.EFF(3),t.k0s()(),t.j41(4,"mat-card-content")(5,"p"),t.EFF(6),t.k0s(),t.j41(7,"p"),t.EFF(8),t.k0s(),t.j41(9,"p"),t.EFF(10),t.k0s()()()),2&n){const e=s.$implicit;t.R7$(3),t.Lme("",e.airline," - ",e.price," USD"),t.R7$(3),t.SpI("Departure: ",e.departureTime,""),t.R7$(2),t.SpI("Arrival: ",e.arrivalTime,""),t.R7$(2),t.SpI("Duration: ",e.duration,"")}}function Ht(n,s){if(1&n&&(t.j41(0,"div",15),t.DNE(1,Zt,11,5,"mat-card",16),t.k0s()),2&n){const e=t.XpG();t.R7$(1),t.Y8G("ngForOf",e.flights)}}function Kt(n,s){1&n&&(t.j41(0,"div",18)(1,"p"),t.EFF(2,"No flights available for the selected route and date."),t.k0s()())}let Wt=(()=>{class n{constructor(e,r){this.fb=e,this.airportservice=r,this.isLoading=!1,this.flights=[],this.searchPerformed=!1}ngOnInit(){this.flightSearchForm=this.fb.group({departureAirport:["",a.k0.required],arrivalAirport:["",a.k0.required],travelDate:["",a.k0.required]})}formatDateForApi(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`}transformFlightData(e){return e.map(r=>({airline:r.airline,price:r.price,departureTime:r.departureTime,arrivalTime:r.arrivalTime,duration:r.duration}))}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(a.ok),t.rXU(B))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-searchflights"]],decls:30,vars:10,consts:[[1,"flight-search-container"],[1,"flight-search-card"],[3,"formGroup"],["appearance","outline"],["matInput","","formControlName","departureAirport","placeholder","Enter departure airport"],[4,"ngIf"],["matInput","","formControlName","arrivalAirport","placeholder","Enter arrival airport"],["matInput","","formControlName","travelDate","placeholder","Choose a date",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["class","loading-spinner",4,"ngIf"],["class","flight-results",4,"ngIf"],["class","no-flights-message",4,"ngIf"],[1,"loading-spinner"],[1,"flight-results"],["class","flight-card",4,"ngFor","ngForOf"],[1,"flight-card"],[1,"no-flights-message"]],template:function(r,o){if(1&r&&(t.j41(0,"div",0)(1,"mat-card",1)(2,"mat-card-title"),t.EFF(3,"Flight Search"),t.k0s(),t.j41(4,"mat-card-content")(5,"form",2),t.EFF(6,'onSearchFlights()" '),t.j41(7,"mat-form-field",3)(8,"mat-label"),t.EFF(9,"Departure Airport"),t.k0s(),t.nrm(10,"input",4),t.DNE(11,Vt,2,0,"mat-error",5),t.k0s(),t.j41(12,"mat-form-field",3)(13,"mat-label"),t.EFF(14,"Arrival Airport"),t.k0s(),t.nrm(15,"input",6),t.DNE(16,Lt,2,0,"mat-error",5),t.k0s(),t.j41(17,"mat-form-field",3)(18,"mat-label"),t.EFF(19,"Travel Date"),t.k0s(),t.nrm(20,"input",7)(21,"mat-datepicker-toggle",8)(22,"mat-datepicker",null,9),t.DNE(24,zt,2,0,"mat-error",5),t.k0s(),t.j41(25,"button",10),t.EFF(26," Search Flights "),t.k0s()()()(),t.DNE(27,Jt,2,0,"div",11),t.DNE(28,Ht,2,1,"div",12),t.DNE(29,Kt,3,0,"div",13),t.k0s()),2&r){const i=t.sdS(23);let l,p,d;t.R7$(5),t.Y8G("formGroup",o.flightSearchForm),t.R7$(6),t.Y8G("ngIf",null==(l=o.flightSearchForm.get("departureAirport"))?null:l.invalid),t.R7$(5),t.Y8G("ngIf",null==(p=o.flightSearchForm.get("arrivalAirport"))?null:p.invalid),t.R7$(4),t.Y8G("matDatepicker",i),t.R7$(1),t.Y8G("for",i),t.R7$(3),t.Y8G("ngIf",null==(d=o.flightSearchForm.get("travelDate"))?null:d.invalid),t.R7$(1),t.Y8G("disabled",o.flightSearchForm.invalid||o.isLoading),t.R7$(2),t.Y8G("ngIf",o.isLoading),t.R7$(1),t.Y8G("ngIf",o.flights.length>0),t.R7$(1),t.Y8G("ngIf",!o.isLoading&&0===o.flights.length&&o.searchPerformed)}},dependencies:[g.Sq,g.bT,a.qT,a.me,a.BC,a.cb,a.j4,a.JD,P.fg,u.rl,u.nJ,u.TL,u.yw,f.$z,c.RN,c.m2,c.MM,c.dh,C.Vh,C.bZ,C.bU,M.LG],styles:[".flight-search-container[_ngcontent-%COMP%]{max-width:600px;margin:2rem auto;padding:1rem}.flight-search-card[_ngcontent-%COMP%]{padding:1.5rem}.mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}button[type=submit][_ngcontent-%COMP%]{width:100%;margin-top:1rem}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:2rem}.flight-results[_ngcontent-%COMP%]{margin-top:2rem}.flight-card[_ngcontent-%COMP%]{margin-bottom:1rem}.no-flights-message[_ngcontent-%COMP%]{text-align:center;margin-top:2rem;font-weight:700}"]})}return n})(),Qt=(()=>{class n{constructor(e,r){this.dialogRef=e,this.data=r}closeDialog(){this.dialogRef.close()}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(_.CP),t.rXU(_.Vh))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-seatwarning"]],decls:8,vars:1,consts:[["mat-raised-button","","color","primary",3,"click"]],template:function(r,o){1&r&&(t.j41(0,"mat-dialog-content")(1,"h2"),t.EFF(2,"Dear Esteemed Customer"),t.k0s(),t.j41(3,"p"),t.EFF(4),t.k0s()(),t.j41(5,"mat-dialog-actions")(6,"button",0),t.bIt("click",function(){return o.closeDialog()}),t.EFF(7,"OK"),t.k0s()()),2&r&&(t.R7$(4),t.JRh(o.data.message))},dependencies:[f.$z,_.Yi,_.E7],styles:["mat-dialog-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#56f056;margin-bottom:1rem}mat-dialog-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2rem}mat-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:center}"]})}return n})();const te=function(n,s,e){return{"available-seat":n,"unavailable-seat":s,"selected-seat":e}};function ee(n,s){if(1&n){const e=t.RV6();t.j41(0,"button",9),t.bIt("click",function(){const i=t.eBV(e).$implicit,l=t.XpG(2);return t.Njj(l.toggleSeatSelection(i))}),t.j41(1,"span"),t.EFF(2),t.k0s(),t.nrm(3,"img",10),t.k0s()}if(2&n){const e=s.$implicit,r=t.XpG(2);t.Y8G("ngClass",t.sMw(4,te,e.isAvailable,!e.isAvailable,e.isSelected)),t.R7$(2),t.Lme("",e.row,"",e.column,""),t.R7$(1),t.Y8G("src",r.getSeatImage(e),t.B4B)}}function re(n,s){if(1&n&&(t.j41(0,"div"),t.DNE(1,ee,4,8,"button",8),t.k0s()),2&n){const e=s.$implicit;t.R7$(1),t.Y8G("ngForOf",e)}}let z=(()=>{class n{constructor(e,r,o,i,l){this.snackBar=e,this.dialog=r,this.route=o,this.authservice=i,this.router=l,this.seats=[],this.selectedSeats=[],this.rows=10,this.columns=6,this.totalPassengers=1,this.userId=this.authservice.getUserId()}ngOnInit(){this.route.queryParams.subscribe(e=>{this.totalPassengers=+e.totalPassengers||1}),this.initializeSeats()}initializeSeats(){let e=1;for(let r=0;r<this.rows;r++){this.seats[r]=[];for(let o=0;o<this.columns;o++)this.seats[r][o]={row:e++,column:this.getColumnLabel(o),isSelected:!1,isAvailable:Math.random()>.2}}}getColumnLabel(e){return String.fromCharCode(65+e)}getSeatImage(e){return e.isAvailable?e.isSelected?"assets/selected-seats.png":"assets/available-seats.png":"assets/seat-unavailable.png"}toggleSeatSelection(e){e.isAvailable?e.isSelected?(e.isSelected=!1,this.selectedSeats=this.selectedSeats.filter(r=>r!==e)):this.selectedSeats.length<this.totalPassengers?(e.isSelected=!0,this.selectedSeats.push(e)):this.snackBar.open(`You can only select up to ${this.totalPassengers} seats`,"Close",{duration:2e3}):this.snackBar.open("Seat is not available","Close",{duration:2e3})}confirmSelection(){if(this.selectedSeats.length===this.totalPassengers){const e=this.route.snapshot.queryParams,r=this.selectedSeats.map(o=>`${o.row}${o.column}`).join(",");this.router.navigate(["flight-booking/payment"],{queryParams:{totalPassengers:this.totalPassengers,departureAirport:e.departureAirportName,arrivalAirport:e.arrivalAirportName,flightCompany:e.flightCompany,price:e.price,departureTime:e.departureTime,arrivalTime:e.arrivalTime,selectedSeats:r,userId:this.userId}})}else this.showSeatCountWarning(`Please select ${this.totalPassengers} seats before proceeding.`)}showSeatCountWarning(e){this.dialog.open(Qt,{data:{message:e},disableClose:!0})}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(y.UG),t.rXU(_.bZ),t.rXU(h.nX),t.rXU(O.u),t.rXU(h.Ix))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-seat-selection"]],decls:19,vars:1,consts:[[1,"legend"],[1,"legend-item"],["src","assets/available-seats.png","alt","Available seat","width","20"],["src","assets/selected-seats.png","alt","Selected seat","width","20"],["src","assets/seat-unavailable.png","alt","Unavailable seat","width","20"],[1,"seat-grid"],[4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",3,"click"],["mat-button","",3,"ngClass","click",4,"ngFor","ngForOf"],["mat-button","",3,"ngClass","click"],["alt","Seat",3,"src"]],template:function(r,o){1&r&&(t.j41(0,"mat-card")(1,"mat-card-title"),t.EFF(2,"Select Your Seats"),t.k0s(),t.j41(3,"div",0)(4,"div",1),t.nrm(5,"img",2),t.EFF(6," Available "),t.k0s(),t.j41(7,"div",1),t.nrm(8,"img",3),t.EFF(9," Selected "),t.k0s(),t.j41(10,"div",1),t.nrm(11,"img",4),t.EFF(12," Unavailable "),t.k0s()(),t.j41(13,"mat-card-content")(14,"div",5),t.DNE(15,re,2,1,"div",6),t.k0s()(),t.j41(16,"mat-card-actions")(17,"button",7),t.bIt("click",function(){return o.confirmSelection()}),t.EFF(18,"Confirm Selection"),t.k0s()()()),2&r&&(t.R7$(15),t.Y8G("ngForOf",o.seats))},dependencies:[g.YU,g.Sq,f.$z,c.RN,c.YY,c.m2,c.dh],styles:["mat-card[_ngcontent-%COMP%]{display:flex;justify-content:space-between;min-width:400px;margin:2rem auto;overflow-y:auto;max-height:400px}.legend[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:10px;margin-bottom:15px}.legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px}.legend[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:10px}.seat-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(6,1fr);gap:10px}.seat-grid[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:relative;margin:2px;width:40px;height:40px;border:none;background:none;border-radius:4px}.seat-grid[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-weight:700}"]})}return n})(),ne=(()=>{class n{constructor(){this.airlines=[{name:"AirPeace",logo:"assets/airpeace.png"},{name:"DanaAir",logo:"assets/arik-logo.png"},{name:"Arik-Air",logo:"assets/dana.png"}]}calculateFare(e,r,o){let i=1e4;return"AirPeace"===o?i+=2e3:"DanaAir"===o?i+=1500:"Arik-Air"===o&&(i+=1e3),i}calculateEstimatedTime(e,r,o){return this.getDistance(e,r)/500}getDepartureTime(e){return"10:00 AM"}getArrivalTime(e){return"2:00 PM"}getAvailableFlights(e,r){return console.log("Fetching available flights from",e,"to",r),this.airlines.map(o=>{const i=this.calculateFare(e,r,o.name),l=1e3*Math.random();return{company:o.name,airlineName:o.name,logoUrl:o.logo,fare:i+l,departureTime:this.getDepartureTime(e),arrivalTime:this.getArrivalTime(r),estimatedTime:this.calculateEstimatedTime(e,r,o.name)}})}getDistance(e,r){return 1e3*Math.random()+500}static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function oe(n,s){1&n&&(t.j41(0,"button",19),t.EFF(1," Selected "),t.k0s())}function ae(n,s){1&n&&(t.j41(0,"div",20)(1,"span"),t.EFF(2,"\u2714\ufe0f Selected"),t.k0s()())}function ie(n,s){if(1&n){const e=t.RV6();t.j41(0,"mat-card",4),t.bIt("click",function(){const i=t.eBV(e).index,l=t.XpG(2);return t.Njj(l.selectFlight(i))}),t.j41(1,"div",5)(2,"div",6)(3,"div",7),t.nrm(4,"img",8),t.j41(5,"span",9),t.EFF(6),t.k0s()(),t.j41(7,"div",10)(8,"div",11)(9,"span",12),t.EFF(10),t.k0s(),t.j41(11,"span",13),t.EFF(12),t.k0s()(),t.j41(13,"div",11)(14,"span",12),t.EFF(15),t.k0s(),t.j41(16,"span",13),t.EFF(17),t.k0s()()()(),t.j41(18,"div",14)(19,"div",15)(20,"span"),t.EFF(21,"Total Fare:"),t.k0s(),t.j41(22,"span",16),t.EFF(23),t.nI1(24,"currency"),t.k0s()()()(),t.j41(25,"mat-card-actions"),t.DNE(26,oe,2,0,"button",17),t.k0s(),t.DNE(27,ae,3,0,"div",18),t.k0s()}if(2&n){const e=s.$implicit,r=s.index,o=t.XpG(2);t.AVh("selected",o.selectedFlightIndex===r),t.R7$(4),t.Mz_("alt","",e.airlineName," Logo"),t.Y8G("src",e.logoUrl,t.B4B),t.R7$(2),t.JRh(e.airlineName),t.R7$(4),t.SpI("Departure: ",e.departureTime,""),t.R7$(2),t.Lme("",o.departureAirportDetails.name,",",o.departureAirportDetails.country,""),t.R7$(3),t.SpI("Arrival: ",e.arrivalTime,""),t.R7$(2),t.Lme("",o.arrivalAirportDetails.name,",",o.arrivalAirportDetails.country,""),t.R7$(6),t.JRh(t.i5U(24,14,e.totalFare,"\u20a6")),t.R7$(3),t.Y8G("ngIf",o.selectedFlightIndex===r),t.R7$(1),t.Y8G("ngIf",o.selectedFlightIndex===r)}}function se(n,s){if(1&n){const e=t.RV6();t.j41(0,"div",21)(1,"button",22),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.confirmSelection())}),t.EFF(2," Confirm Selection and Continue "),t.k0s()()}}function le(n,s){if(1&n&&(t.j41(0,"div")(1,"div",1),t.DNE(2,ie,28,17,"mat-card",2),t.k0s(),t.DNE(3,se,3,0,"div",3),t.k0s()),2&n){const e=t.XpG();t.R7$(2),t.Y8G("ngForOf",e.flightOptions),t.R7$(1),t.Y8G("ngIf",null!==e.selectedFlightIndex)}}function ce(n,s){1&n&&(t.j41(0,"div"),t.EFF(1," Loading or missing airport data... "),t.k0s())}let J=(()=>{class n{constructor(e,r,o,i){this.route=e,this.fareService=r,this.router=o,this.authservice=i,this.departureAirportDetails=null,this.arrivalAirportDetails=null,this.flightOptions=[],this.selectedFlightIndex=null,this.userId=null,this.airlineLogos={AirPeace:"assets/airpeace.png",DanaAir:"assets/arik-logo.png","Arik-Air":"assets/dana.png"}}ngOnInit(){this.userId=this.authservice.getUserId(),this.route.queryParams.subscribe(e=>{const r=e.departureAirportName,o=e.departureAirportcountry,i=e.arrivalAirportName,l=e.arrivalAirportcountry,p=parseInt(e.totalPassengers)||1;this.departureAirportDetails={name:r,country:o},this.arrivalAirportDetails={name:i,country:l},this.loadFlightDetails(p)})}loadFlightDetails(e){this.flightOptions=["AirPeace","DanaAir","Arik-Air"].map(o=>{const i=this.fareService.calculateFare(this.departureAirportDetails.name,this.arrivalAirportDetails.name,o),l=this.fareService.calculateEstimatedTime(this.departureAirportDetails.name,this.arrivalAirportDetails.name,o),p=this.fareService.getDepartureTime(this.departureAirportDetails.name),d=this.fareService.getArrivalTime(this.arrivalAirportDetails.name);return{airlineName:o,logoUrl:this.airlineLogos[o],totalFare:i*e,departureTime:p,arrivalTime:d,estimatedTime:l}})}selectFlight(e){this.selectedFlightIndex=e}confirmSelection(){if(null!==this.selectedFlightIndex&&this.userId){const e=this.flightOptions[this.selectedFlightIndex];this.router.navigate(["flight-booking/passenger-info"],{queryParams:{departureAirportName:this.departureAirportDetails?.name,arrivalAirportName:this.arrivalAirportDetails?.name,totalPassengers:this.route.snapshot.queryParams.totalPassengers,flightCompany:e.airlineName,price:e.totalFare,departureTime:e.departureTime,arrivalTime:e.arrivalTime,userId:this.userId}})}else console.error("No flight selected or user not logged in.")}static#t=this.\u0275fac=function(r){return new(r||n)(t.rXU(h.nX),t.rXU(ne),t.rXU(h.Ix),t.rXU(O.u))};static#e=this.\u0275cmp=t.VBU({type:n,selectors:[["app-flight-details"]],decls:2,vars:2,consts:[[4,"ngIf"],[1,"fare-card-container"],["class","fare-card",3,"selected","click",4,"ngFor","ngForOf"],["class","confirm-selection",4,"ngIf"],[1,"fare-card",3,"click"],[1,"fare-details"],[1,"flight-info"],[1,"flight-company"],[1,"flight-logo",3,"src","alt"],[1,"company-name"],[1,"flight-times"],[1,"time-info"],[1,"time"],[1,"airport"],[1,"fare-summary"],[1,"fare-row","total"],[1,"amount"],["mat-raised-button","","color","primary",4,"ngIf"],["class","selected-status",4,"ngIf"],["mat-raised-button","","color","primary"],[1,"selected-status"],[1,"confirm-selection"],["mat-raised-button","","color","accent",3,"click"]],template:function(r,o){1&r&&(t.DNE(0,le,4,2,"div",0),t.DNE(1,ce,2,0,"div",0)),2&r&&(t.Y8G("ngIf",o.departureAirportDetails&&o.arrivalAirportDetails),t.R7$(1),t.Y8G("ngIf",!o.departureAirportDetails||!o.arrivalAirportDetails))},dependencies:[g.Sq,g.bT,f.$z,c.RN,c.YY,g.oe],styles:[".fare-card[_ngcontent-%COMP%]{max-width:500px;margin:2rem auto;padding:1.5rem;background-color:#f5f5f5;border-radius:8px;box-shadow:0 4px 10px #0000001a}.fare-card[_ngcontent-%COMP%]   .fare-details[_ngcontent-%COMP%]{display:flex;flex-direction:column}.fare-card[_ngcontent-%COMP%]   .fare-details[_ngcontent-%COMP%]   .flight-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:1rem}.fare-card[_ngcontent-%COMP%]   .fare-details[_ngcontent-%COMP%]   .flight-info[_ngcontent-%COMP%]   .flight-company[_ngcontent-%COMP%]{display:flex;align-items:center}.fare-card[_ngcontent-%COMP%]   .fare-details[_ngcontent-%COMP%]   .flight-info[_ngcontent-%COMP%]   .flight-company[_ngcontent-%COMP%]   .flight-logo[_ngcontent-%COMP%]{width:40px;height:40px;margin-right:10px}.fare-card[_ngcontent-%COMP%]   .fare-details[_ngcontent-%COMP%]   .flight-info[_ngcontent-%COMP%]   .flight-company[_ngcontent-%COMP%]   .company-name[_ngcontent-%COMP%]{font-weight:600;font-size:1.1rem;color:#333}.fare-card[_ngcontent-%COMP%]   .fare-details[_ngcontent-%COMP%]   .flight-info[_ngcontent-%COMP%]   .flight-times[_ngcontent-%COMP%]{display:flex;flex-direction:column}.fare-card[_ngcontent-%COMP%]   .fare-details[_ngcontent-%COMP%]   .flight-info[_ngcontent-%COMP%]   .flight-times[_ngcontent-%COMP%]   .time-info[_ngcontent-%COMP%]{margin-bottom:5px}.fare-card[_ngcontent-%COMP%]   .fare-details[_ngcontent-%COMP%]   .flight-info[_ngcontent-%COMP%]   .flight-times[_ngcontent-%COMP%]   .time-info[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-weight:500;color:#444}.fare-card[_ngcontent-%COMP%]   .fare-details[_ngcontent-%COMP%]   .flight-info[_ngcontent-%COMP%]   .flight-times[_ngcontent-%COMP%]   .time-info[_ngcontent-%COMP%]   .airport[_ngcontent-%COMP%]{font-size:15px;color:#000;margin-left:3px}.fare-card[_ngcontent-%COMP%]   .fare-details[_ngcontent-%COMP%]   .fare-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column}.fare-card[_ngcontent-%COMP%]   .fare-details[_ngcontent-%COMP%]   .fare-summary[_ngcontent-%COMP%]   .fare-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px;font-size:1rem;color:#555}.fare-card[_ngcontent-%COMP%]   .fare-details[_ngcontent-%COMP%]   .fare-summary[_ngcontent-%COMP%]   .fare-row.total[_ngcontent-%COMP%]{font-weight:600;color:#333;font-size:1.2rem}.fare-card[_ngcontent-%COMP%]   .fare-details[_ngcontent-%COMP%]   .fare-summary[_ngcontent-%COMP%]   .fare-row[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:500}.fare-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;margin-top:1.5rem;font-size:1rem}.fare-card-container[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto;padding:10px}.fare-card[_ngcontent-%COMP%]{margin-bottom:15px;transition:transform .3s,box-shadow .3s;cursor:pointer}.fare-card.selected[_ngcontent-%COMP%]{transform:scale(1.02);box-shadow:0 4px 8px #0003}.selected-status[_ngcontent-%COMP%]{color:green;font-weight:700;padding-top:10px;animation:_ngcontent-%COMP%_fadeIn .5s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}"]})}return n})();const pe=[{path:"",component:w,children:[{path:"",redirectTo:"booking-details",pathMatch:"full"},{path:"booking-details",component:X},{path:"seats",component:z},{path:"flight-details",component:J},{path:"searchflights",component:Wt},{path:"passenger-info",component:$},{path:"payment",component:L}]}];let me=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.$C({type:n});static#r=this.\u0275inj=t.G2t({imports:[h.iI.forChild(pe),h.iI]})}return n})();var de=m(1997),ge=m(2765);const ue=[{path:"",component:w,children:[{path:"",redirectTo:"booking-details",pathMatch:"full"},{path:"booking-details",component:X},{path:"seats",component:z},{path:"flight-details",component:J},{path:"passenger-info",component:$},{path:"passenger-iterate",component:R},{path:"payment",component:L}]}];let he=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.$C({type:n});static#r=this.\u0275inj=t.G2t({imports:[g.MD,me,a.X1,N.jL,P.fS,q.PO,f.Hl,c.Hu,A.m_,y._T,u.RG,I.Ve,C.X6,T.WX,_.hM,de.w,ge.g7,M.D6,k.q1,h.iI.forChild(ue),h.iI]})}return n})()}}]);